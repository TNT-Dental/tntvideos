/* get device */
function getOS(){var i=navigator.userAgent||navigator.vendor||window.opera;return i.match(/iPad/i)||i.match(/iPhone/i)||i.match(/iPod/i)?"iOS":i.match(/Android/i)?"Android":"unknown"}

/* retrive youtube video */
jQuery.fn.setupYoutube=function(){iframe=document.createElement("iframe"),iframe.setAttribute("frameborder","0"),iframe.setAttribute("allowfullscreen",""),iframe.setAttribute("width",this.attr("data-width")),iframe.setAttribute("height",this.attr("data-height")),iframe.setAttribute("src","https://www.youtube.com/embed/"+this.attr("data-embed")+"?rel=0&autoplay=1&playsinline=1&enablejsapi=1"),this.prepend(iframe);var e=iframe.height/iframe.width*100;iframe.style.position="absolute",iframe.style.top="0",iframe.style.left="0",iframe.style.right="0",iframe.width="100%",iframe.height="100%";var t=document.createElement("div");t.className="fluid-vid",t.style.width="100%",t.style.position="relative",t.style.paddingTop=e+"%",iframe.parentNode.insertBefore(t,iframe),t.appendChild(iframe)};

/* youtube lazy-load */
$(".youtube").each(function(){$(this).is(":empty")&&$(this).empty().append('<img alt="youtube thumbnail" class="thumbnail" src="https://img.youtube.com/vi/'+$(this).data("embed")+'/maxresdefault.jpg">'),$(this).on("click",function(){$(this).find(".thumbnail").remove();for(var t=0;t<$("iframe").length;t++)$("iframe")[t].contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*");$(this).addClass("active").setupYoutube()})});

/* tntvideos 1.3 */
!function(e){e.fn.extend({tntvideos:function(t){var i={playButton:".play",closeButton:".close",closeButtonString:null,animate:!0,offset:e("header").outerHeight(),bodyPlaying:null,mobileWidth:900,mobileAppendPlay:null,onPlay:function(){},onClose:function(){}};t=e.extend(i,t);var a=this.length-1;return this.each(function(i){var l=t,s=l.closeButton.replace(/\./g,""),m=e(this),u=m.data("player");if(e(window).width()>l.mobileWidth&&("vimeo-solo"==u&&"static"==m.data("mode")||"youtube"!=u&&(e(this).find(".thumbnail").remove(),o(m))),e(window).width()<l.mobileWidth&&(null==l.mobileAppendPlay||e(this).data("mobile-append-play")?e(this).data("mobile-append-play")?e(this).find(l.playButton).appendTo(e(this).find(e(this).data("mobile-append-play"))):e(this).find(l.playButton).appendTo(e(this).find("[data-embed]")):e(this).find(l.playButton).appendTo(e(this).find(l.mobileAppendPlay))),null!=l.closeButtonString)var r=l.closeButtonString;else r='<i class="icon-plus"></i> Close Video';if(e(this).on("click",l.playButton,function(){var i=m.data("player");null!=l.bodyPlaying&&e("body").addClass(l.bodyPlaying.replace(/\./g,"")),m.find(l.playButton).hide(),"vimeo"==i?(m.find("video").remove(),d(m,s,r)):"youtube"==i?(m.find(".thumbnail").hide(),function(t,i,a){t.addClass("playing").find("[data-embed]").append('<a class="'+i+'">'+a+"</a>"),t.find(".thumbnail").hide();for(var o=0;o<e("iframe").length;o++)e("iframe")[o].contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*");t.addClass("active").find("[data-embed]").setupYoutube()}(m,s,r)):(i="vimeo-solo")&&("swap"==m.data("mode")?(m.find("video").remove(),m.find(".thumbnail").hide(),d(m,s,r)):e(window).width()<l.mobileWidth||"static"==m.data("mode")?(m.find(".thumbnail").hide(),o(m),n(m,s,r)):n(m,s,r));for(var a=0;a<e("iframe").length;a++)e("iframe")[a].contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*");return e(window).width()>l.mobileWidth&&1==l.animate&&(console.log(l.offset),e("html, body").animate({scrollTop:m.offset().top+l.offset},1e3)),t.onPlay.call(this),!1}),e(this).on("click",l.closeButton,function(){var i=e(this).parents("[data-player]"),a=i.data("player");i.removeClass("playing"),i.find(l.closeButton).remove(),i.find(l.playButton).show(),i.find(".fluid-vid, iframe").remove(),null!=l.bodyPlaying&&e("body").removeClass(l.bodyPlaying.replace(/\./g,""));return"vimeo"==a?e(window).width()<t.mobileWidth||"static"==i.data("mode")?(i.find("video, iframe").remove(),i.find(".thumbnail").show()):o(i):"youtube"==a?i.find(".thumbnail").show():"vimeo-solo"==a&&(e(window).width()<t.mobileWidth||"static"==i.data("mode")?(i.find("video, iframe").remove(),i.find(".thumbnail").show()):"swap"==i.data("mode")?(i.find("video").remove(),o(i)):n(i,s,r,!0)),e(window).width()>l.mobileWidth&&1==l.animate&&e("html, body").animate({scrollTop:i.offset().top-l.offset},1e3),t.onClose.call(this),!1}),i==a)return!1});function o(e){e.find("[data-embed]").prepend('<video autoplay="true" muted="muted" loop="true" src="https://player.vimeo.com/external/'+e.data("vimeo")+'&profile_id=174"></video>')}function d(e,t,i){e.addClass("playing").find("[data-embed]").append('<a class="'+t+'">'+i+"</a>"),"swap"==e.data("mode")?function(e){var t=e.find("[data-embed]");console.log("is swap mobile"),e.find("[data-embed]").prepend('<video controls autoplay="true" src="https://player.vimeo.com/external/'+t.data("embed")+'&profile_id=174"></video>')}(e):(e.find("[data-embed]").setupYoutube(),e.find("video, .thumbnail").hide())}function n(e,t,i,a){var o=e.find("video");a?(e.removeClass("playing"),o.attr({controls:"false",muted:"true",loop:"true"}),o[0].muted=1,o[0].controls=0,o[0].play()):(e.addClass("playing").find("[data-embed]").append('<a class="'+t+'">'+i+"</a>").find(".thumbnail").hide(),o.attr({controls:"true",muted:"false",loop:"false"}),o[0].currentTime=0,o[0].muted=0,o[0].controls=1)}}})}(jQuery);
